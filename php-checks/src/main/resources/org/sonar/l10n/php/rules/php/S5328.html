<h2>Why is this an issue?</h2>
<p>Session IDs are used to identify a user session. They are usually stored in cookies, URL parameters, or hidden form fields.</p>
<p>If a session ID can be guessed (not generated with a secure pseudo random generator, or with insufficient length …​) an attacker may be able to
hijack another user’s session.</p>
<p>If an application allows users to specify their own session ID (for example via URL parameters or form fields), an attacker may be able to set a
known session ID for a victim user, and then hijack the victim’s session (session fixation attack).</p>
<h2>How to fix it</h2>
<p>Don’t manually generate session IDs, use instead language based native functionality. In PHP, use session_regenerate_id() to generate a new session
ID, or use session_id() with a securely generated random value of sufficient length (at least 16 bytes).</p>
<h3>Code Examples</h3>
<h3>Noncompliant Code Example</h3>
<pre data-diff-id="1" data-diff-type="noncompliant">
session_id(bin2hex(random_bytes(4))); // Noncompliant, 4 bytes is too short
session_id($_POST["session_id"]); // Noncompliant, session ID can be specified by the user
</pre>
<h4>Compliant Solution</h4>
<pre data-diff-id="1" data-diff-type="compliant">
session_regenerate_id(); ; // Compliant
session_id(bin2hex(random_bytes(16))); // Compliant
</pre>
<h2>Resources</h2>
<ul>
  <li> OWASP - <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">Top 10 2021 Category A4 - Insecure Design</a> </li>
  <li> OWASP - <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">Top 10 2021 Category A7 - Identification and
  Authentication Failures</a> </li>
  <li> OWASP - <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">Top 10 2017 Category A6 - Security
  Misconfiguration</a> </li>
  <li> <a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a> </li>
  <li> CWE - <a href="https://cwe.mitre.org/data/definitions/330">CWE-330 - Use of Insufficiently Random Values</a> </li>
  <li> CWE - <a href="https://cwe.mitre.org/data/definitions/340">CWE-340 - Generation of Predictable Numbers or Identifiers</a> </li>
  <li> <a href="https://www.php.net/random-bytes">PHP: random_bytes()</a> </li>
  <li> <a href="https://www.php.net/session-regenerate-id">PHP: session_regenerate_id()</a> </li>
  <li> STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222579">Application Security and
  Development: V-222579</a> - Applications must use system-generated session identifiers that protect against session fixation. </li>
  <li> STIG Viewer - <a href="https://stigviewer.com/stigs/application_security_and_development/2024-12-06/finding/V-222582">Application Security and
  Development: V-222582</a> - The application must not re-use or recycle session IDs. </li>
</ul>

